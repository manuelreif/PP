<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with Person-Fit in PP • PP</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/slate/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started with Person-Fit in PP">
<meta property="og:description" content="PP">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.3-11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro_pfit.html">Getting started with Person-Fit in PP</a>
    </li>
    <li>
      <a href="../articles/intro_pp.html">Getting started with PP</a>
    </li>
    <li>
      <a href="../articles/ppass_par_and_fit.html">Analyzing a dataset</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jansteinfeld/PP/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_pfit_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with Person-Fit in PP</h1>
                        <h4 class="author">Jan Steinfeld</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jansteinfeld/PP/blob/master/vignettes/intro_pfit.Rmd"><code>vignettes/intro_pfit.Rmd</code></a></small>
      <div class="hidden name"><code>intro_pfit.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Getting started with Person-Fit in PP}
%\VignetteEncoding{UTF-8}
-->
<div id="getting-started-with-person-fit-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started-with-person-fit-functions" class="anchor"></a>Getting started with Person-Fit functions</h1>
<p>A brief introduction of all currently implemented person-fit functions will be added soon. Currently the <strong>LZ, LZ</strong>* and also the <strong>Infit-Outfit-Statistics</strong> are implemented. We also added the Infit-Outfit-Functions for the Partial-Credit Model. Meanwhile we are working on plots for a better understanding of the person misfit as well as on inference statistic methods.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>message <span class="op">=</span> <span class="cn">FALSE</span>, results<span class="op">=</span><span class="st">'hide'</span><span class="op">)</span></code></pre></div>
<div id="first-example" class="section level2">
<h2 class="hasAnchor">
<a href="#first-example" class="anchor"></a>First example</h2>
<p>Now a simple example will be given. First, we will simulate some data for our hands on example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jansteinfeld/PP">PP</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1337</span><span class="op">)</span>

<span class="co"># simulate some intercepts</span>
<span class="va">diffpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span>,length<span class="op">=</span><span class="fl">15</span><span class="op">)</span>
<span class="co"># simulate some slope parameters</span>
<span class="va">sl</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">la</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">0.25</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">ua</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0.8</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>

<span class="co"># simulate response matrix (not following any IRT model)</span>
<span class="va">awm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,<span class="fl">100</span><span class="op">*</span><span class="fl">15</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">15</span><span class="op">)</span></code></pre></div>
<p>We will start with a simple 1PL-Model. First, we have to estimate the person parameters. Here we have to choose an estimation method. It is important, that you can choose <strong>mle, wle or map</strong> only for the LZ and LZ* Index. For the Infit-Outfit statistic we support <strong>mle and wle</strong> estimates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MLE</span>
<span class="va">res1plmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>,type <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span>
<span class="co"># WLE</span>
<span class="va">res1plwle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>,type <span class="op">=</span> <span class="st">"wle"</span><span class="op">)</span></code></pre></div>
<p>We also support the 2PL, 3PL and 4PL Model:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 2PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># MLE</span>
<span class="va">res2plmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>, slopes <span class="op">=</span> <span class="va">sl</span>,type <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span>
<span class="co"># WLE</span>
<span class="va">res2plwle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>, slopes <span class="op">=</span> <span class="va">sl</span>,type <span class="op">=</span> <span class="st">"wle"</span><span class="op">)</span>

<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 3PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># MLE</span>
<span class="va">res3plmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>,
                    slopes <span class="op">=</span> <span class="va">sl</span>,lowerA <span class="op">=</span> <span class="va">la</span>,type <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span>
<span class="co"># WLE</span>
<span class="va">res3plwle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>,
                    slopes <span class="op">=</span> <span class="va">sl</span>,lowerA <span class="op">=</span> <span class="va">la</span>,type <span class="op">=</span> <span class="st">"wle"</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 4PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># MLE</span>
<span class="va">res4plmle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>,
                    slopes <span class="op">=</span> <span class="va">sl</span>,lowerA <span class="op">=</span> <span class="va">la</span>,upperA<span class="op">=</span><span class="va">ua</span>,type <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span>
<span class="co"># WLE</span>
<span class="va">res4plwle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PP_4pl.html">PP_4pl</a></span><span class="op">(</span>respm <span class="op">=</span> <span class="va">awm</span>,thres <span class="op">=</span> <span class="va">diffpar</span>,
                    slopes <span class="op">=</span> <span class="va">sl</span>,lowerA <span class="op">=</span> <span class="va">la</span>,upperA<span class="op">=</span><span class="va">ua</span>,type <span class="op">=</span> <span class="st">"wle"</span><span class="op">)</span></code></pre></div>
<p>After the estimation of the person parameter we are able to calculate the person fits. At this point you are able to calculate only one kind of personfit as well as all various simultaneously (as shown next).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 1PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## LZ*-Index #####</span>
<span class="va">pfit1pl_lz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res1plwle</span>,fitindices<span class="op">=</span><span class="st">"lzstar"</span><span class="op">)</span>
<span class="co">## LZ*-Index combined with Infit-Outfit #####</span>
<span class="va">pfit1pl_li</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res1plwle</span>,fitindices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lzstar"</span>,<span class="st">"infit"</span>,<span class="st">"outfit"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 2PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## LZ*-Index #####</span>
<span class="va">pfit2pl_lz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res2plwle</span>,fitindices<span class="op">=</span><span class="st">"lzstar"</span><span class="op">)</span>
<span class="co">## LZ*-Index combined with Infit-Outfit #####</span>
<span class="va">pfit2pl_li</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res2plwle</span>,fitindices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lzstar"</span>,<span class="st">"infit"</span>,<span class="st">"outfit"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 3PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## LZ*-Index #####</span>
<span class="va">pfit3pl_lz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res3plwle</span>,fitindices<span class="op">=</span><span class="st">"lzstar"</span><span class="op">)</span>
<span class="co">## LZ*-Index combined with Infit-Outfit #####</span>
<span class="va">pfit3pl_li</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res3plwle</span>,fitindices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lzstar"</span>,<span class="st">"infit"</span>,<span class="st">"outfit"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 4PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## LZ*-Index #####</span>
<span class="va">pfit4pl_lz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res4plwle</span>,fitindices<span class="op">=</span><span class="st">"lzstar"</span><span class="op">)</span>
<span class="co">## LZ*-Index combined with Infit-Outfit #####</span>
<span class="va">pfit4pl_li</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res4plwle</span>,fitindices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lzstar"</span>,<span class="st">"infit"</span>,<span class="st">"outfit"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can also use different person parameter estimates.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## 1PL model #####</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">## LZ*-Index #####</span>
<span class="co">## mle ####</span>
<span class="va">pfit1pl_mle_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res1plmle</span>,fitindices<span class="op">=</span><span class="st">"lzstar"</span><span class="op">)</span>
<span class="co">## wle ####</span>
<span class="va">pfit1pl_wle_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res1plwle</span>,fitindices<span class="op">=</span><span class="st">"lzstar"</span><span class="op">)</span></code></pre></div>
<p>If desired you can simply plot the results of the person-fit statistics as shown below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># eine Grafik erzeugen</span>

<span class="va">res.pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pfit.html">Pfit</a></span><span class="op">(</span>respm<span class="op">=</span><span class="va">awm</span>,pp<span class="op">=</span><span class="va">res1plmle</span>,fitindices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lzstar"</span><span class="op">)</span>,SE<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span>,length<span class="op">=</span><span class="fl">200</span><span class="op">)</span>
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">s</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">s</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8.5</span>,<span class="fl">8.5</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Density plot of lz* Person-Fit"</span>, xlab<span class="op">=</span><span class="st">"density"</span>, ylab<span class="op">=</span><span class="st">"score"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.pp</span><span class="op">$</span><span class="va">lzstar</span><span class="op">[</span>,<span class="st">"lzstar"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">res.pp</span><span class="op">$</span><span class="va">lzstar</span><span class="op">[</span>,<span class="st">"lzstar"</span><span class="op">]</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_pfit_files/figure-html/example-1-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># zweite Grafik erzeugen</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.pp</span><span class="op">$</span><span class="va">lzstar</span><span class="op">)</span>
<span class="va">avg</span> <span class="op">&lt;-</span> <span class="va">res.pp</span><span class="op">$</span><span class="va">lzstar</span><span class="op">[</span>,<span class="st">"lzstar"</span><span class="op">]</span>
<span class="va">sdev</span> <span class="op">&lt;-</span> <span class="va">res.pp</span><span class="op">$</span><span class="va">lzstar</span><span class="op">[</span>,<span class="st">"lzs_se"</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">avg</span>, <span class="va">x</span>,
     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">avg</span><span class="op">-</span><span class="va">sdev</span>, <span class="va">avg</span><span class="op">+</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span>,
     pch<span class="op">=</span><span class="fl">19</span>, ylab<span class="op">=</span><span class="st">"Person"</span>, xlab<span class="op">=</span><span class="st">"Person-Fit +/- SD"</span>,
     main<span class="op">=</span><span class="st">"Plot of Person-Fit with SE"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="va">avg</span><span class="op">-</span><span class="va">sdev</span>, <span class="va">x</span>, <span class="va">avg</span><span class="op">+</span><span class="va">sdev</span>, length<span class="op">=</span><span class="fl">0.05</span>, angle<span class="op">=</span><span class="fl">90</span>, code<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>,col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="intro_pfit_files/figure-html/example-1-2.png" width="700"></p>
</div>
<div id="real-data-example" class="section level2">
<h2 class="hasAnchor">
<a href="#real-data-example" class="anchor"></a>Real data example</h2>
<p>First we have to load the dataset</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">pp_amt</span><span class="op">)</span>
<span class="va">betas</span> <span class="op">&lt;-</span> <span class="va">pp_amt</span><span class="op">$</span><span class="va">betas</span><span class="op">$</span><span class="va">Itemparameter</span>
<span class="va">diffpar</span> <span class="op">&lt;-</span> <span class="va">pp_amt</span><span class="op">$</span><span class="va">Itemparameter</span>
<span class="co"># slope parameters</span>
<span class="va">awm</span> <span class="op">&lt;-</span> <span class="va">pp_amt</span><span class="op">$</span><span class="va">daten_amt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"i\\d{1,3}"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">pp_amt</span><span class="op">$</span><span class="va">daten_amt</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>

<span class="co"># estimate ability parameter and personfit</span>
<span class="co"># the computation of the standard error takes a while, therefore we use only a part of the provided data</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1800</span><span class="op">)</span>
<span class="co"># sample items</span>
<span class="va">sampi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">awm</span><span class="op">)</span>,<span class="fl">40</span>,replace <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>
<span class="co"># sample persons</span>
<span class="va">sampp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">awm</span><span class="op">)</span>,<span class="fl">100</span>,replace <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>
<span class="va">awm.samp</span> <span class="op">&lt;-</span> <span class="va">awm</span><span class="op">[</span><span class="va">sampp</span>,<span class="va">sampi</span><span class="op">]</span>
<span class="co"># apply(awm.samp, 2, function(x)!all(is.na(x)))</span>
<span class="va">awm.samp</span> <span class="op">&lt;-</span> <span class="va">awm.samp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">awm.samp</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span> <span class="co">#only persons with no NA</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PPass.html">PPass</a></span><span class="op">(</span>respdf <span class="op">=</span> <span class="va">awm.samp</span>,thres <span class="op">=</span> <span class="va">betas</span><span class="op">[</span><span class="va">sampi</span><span class="op">]</span>, items<span class="op">=</span><span class="st">"all"</span>,type <span class="op">=</span> <span class="st">"wle"</span>,
             mod<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1PL"</span><span class="op">)</span>, fitindices<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lz"</span>,<span class="st">"lzstar"</span>,<span class="st">"infit"</span>,<span class="st">"outfit"</span><span class="op">)</span>,SE<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># first example of illustration</span>
<span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">lim</span>,<span class="va">lim</span>,length<span class="op">=</span><span class="fl">200</span><span class="op">)</span>
<span class="va">s</span>  <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">s</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">s</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">lim</span>,<span class="va">lim</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Density plot of lz* Person-Fit"</span>, xlab<span class="op">=</span><span class="st">"density"</span>, ylab<span class="op">=</span><span class="st">"score"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="st">"lzstar"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="st">"lzstar"</span><span class="op">]</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_pfit_files/figure-html/example-2-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># second example of illustration</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>
<span class="va">avg</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[</span>,<span class="st">"lzstar"</span><span class="op">]</span>
<span class="va">sdev</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[</span>,<span class="st">"lzs_se"</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">avg</span>, <span class="va">x</span>,
     yaxt<span class="op">=</span><span class="st">"n"</span>,
     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">avg</span><span class="op">-</span><span class="va">sdev</span>, <span class="va">avg</span><span class="op">+</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span>,
     pch<span class="op">=</span><span class="fl">19</span>, ylab<span class="op">=</span><span class="st">"Person"</span>, xlab<span class="op">=</span><span class="st">"Person-Fit +/- SD"</span>,
     main<span class="op">=</span><span class="st">"Plot of Person-Fit with SE"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span>,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">2</span>,cex.axis<span class="op">=</span><span class="fl">0.66</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="va">avg</span><span class="op">-</span><span class="va">sdev</span>, <span class="va">x</span>, <span class="va">avg</span><span class="op">+</span><span class="va">sdev</span>, length<span class="op">=</span><span class="fl">0.05</span>, angle<span class="op">=</span><span class="fl">90</span>, code<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>,col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="intro_pfit_files/figure-html/example-2-2.png" width="700"></p>
<p><strong>Interpretation of some selected person-fit statistics.</strong></p>
<p>In the second example we used the provided real dataset of the ‘Adaptive Matrices Test’. Theses data where collected at the Unitersity of Vienna, Fakulty of Psychology, Division of Psychological Assessment and Applied Psychometrics. In the second plot we used only a subset of the provided data, because the computation of the standard error (here we used a jackknife (Efron &amp; Stein, 1981)) takes a while. Magis, Raîche &amp; Béland (2012) and also Armstrong, Stoumbos, Kung and Shi (2007) provide useful information for the inrepretation of the lz (Drasgow, Levine &amp; Williams, 1985) and lz* (Snijders, 2001) person-fit index. The interpretation of the lz-values is very simple. The smaller (negative) the values, the stronger the indicated misfit. The lz-values ar asymptotically standard normally distributed. Molenaar and Hoijtink (1990) (and others) showed, that the asymptotically standard normal distrubution only holds, if the <span class="math inline">\(\theta\)</span> values are known. To overcome thes problem Snijders (2001) intruduced his lz* person-fit index. The inrepration of this index does not change. In summary Magis, Raîche &amp; Béland (2012) propose if the lz* index is lower than a certain critical value <span class="math inline">\(z_\alpha\)</span>, than this person-fit value indicates a misfit.</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Armstrong, R.D., Z.G. Stoumbos, M.T. Kung, and M. Shi. 2007. On the Performance of the Lz Person-Fit Statistic. <em>Practical Assessment, Research &amp; Evaluation</em>, 12(16).</p>
<p>Drasgow, F., M.V. Levine, and E.A. Williams. 1985. Appropriateness Measurement with Polychotomous Item Response Models and Standardized Indices. <em>British Journal of Mathematical and Statistical Psychology</em>, 38(1). Wiley Online Library: 67-86.</p>
<p>Efron, B., and C. Stein. 1981. The Jackknife Estimate of Variance. <em>The Annals of Statistics JSTOR</em>, 586-96.</p>
<p>Magis, D., G. Raîche, and S. Béland. 2012. A Didactic Presentation of Snijders’s Lz* Index of Person Fit with Emphasis on Response Model Selection and Ability Estimation <em>Journal of Educational and Behavioral Statistics</em>, 37(1). SAGE Publications Sage CA: Los Angeles, CA: 57-81.</p>
<p>Molenaar, I.W., and H. Hoijtink. 1990. The Many Null Distributions of Person Fit Indices. <em>Psychometrika</em>, 55(1). Springer: 75-106.</p>
<p>Snijders, T.AB. 2001. Asymptotic Null Distribution of Person Fit Statistics with Estimated Person Parameter. <em>Psychometrika</em>}, 66(3). Springer: 331-342.</p>
<p>Snijders, T.B. 2001. Asymptotic Null Distribution of Person Fit Statistics with Estimated Person Parameter. <em>Rasch Measurement Transactions</em>, 66(3): 331-342.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jan Steinfeld, Manuel Reif.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
